@startuml C4_Elements
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Container.puml

LAYOUT_WITH_LEGEND()

Person(user, "User", "A user with an account.")

System_Ext(auth, "Identity provider", "The identity provider for authorization.")

System_Boundary(boundry, "Info-map"){
	Container(spa, "Single-Page Application", "React + TypeScript", "Provides the info-map functionality to the user via the web browser.")

	Container(api, "API Gateway", "Spring MVC + Java + Redis", "Provides data to the front-end, controls caching and authorization.")
	
	Container(map_service, "Map: Microservice", "Rust + Actix", "Retrieves the users info-maps.")
	ContainerDb(map_db, "Map: Database", "PostgreSQL", "Stores users info-map data.")

	Container(note_service, "Notes: Microservice", "Rust + Actix", "Retrieves the info-map notes.")
	ContainerDb(note_db, "Note: Database", "PostgreSQL", "Stores users info-map data.")

	Container(component_service, "Component: Microservice", "Rust + Actix", "Retrieves the info-map notes.")
	ContainerDb(component_db, "Component: Database", "PostgreSQL", "Stores users info-map data.")

	Container(text_service, "Text: Microservice", "Rust + Actix", "Retrieves the users info-map.")
	ContainerDb(text_db, "Text: Database", "PostgreSQL", "Stores users info-map data.")

	Container(image_service, "Image: Microservice", "Rust + Actix", "Retrieves the users info-map.")
	ContainerDb(image_db, "Image: Database", "PostgreSQL", "Stores users info-map data.")
}
Rel(user, spa, "Views their info-map, and makes changes to it.")

Rel(spa, api, "Makes API calls to", "JSON/HTTPS")
Rel(spa, auth, "Makes API calls to", "JSON/HTTPS")

Rel(api, map_service, "Makes API calls to", "JSON/HTTPS")
Rel(map_service, map_db, "Reads from and writes to")

Rel(api, note_service, "Makes API calls to", "JSON/HTTPS")
Rel(note_service, component_service, "Makes API calls to", "JSON/HTTPS")
Rel(note_service, note_db, "Makes API calls to", "JSON/HTTPS")

Rel(component_service, image_service, "Makes API calls to", "JSON/HTTPS")
Rel(component_service, text_service, "Makes API calls to", "JSON/HTTPS")

Rel(component_service, component_db, "Reads from and writes to")
Rel(text_service, text_db, "Reads from and writes to")
Rel(image_service, image_db, "Reads from and writes to")
@enduml
